---
title: ionic在移动端react项目中的使用
date: 2020-07-20 10:10:04
categories:
  - web
tags:
  - coding
  - 实践
---

最近接触了一个移动端的 2C 项目， 上一次做 2C 的项目已经可以追溯到遥远的毕业第一年了。能够把这些年间歇看到的 2C 的一些知识点进行应用还是挺有趣的。 在项目中，我们使用了 ionic 来作为移动端 h5 的组件库，经过一个多月的使用，也总结了一些经验。

# why？

我们都知道做 h5 或者 SPA 较之原生 app 在性能上的巨大差距。于是市面上有很多 hybird 的库都是封装原生的实现，提供 js 的编码接口，其代表就是 React Naive。 但使用 RN 本身需要一定的原生开发经验，对开发人员有一定的要求，一方面我担心未来的坑不好踩，另一方面也担心新人培养成本和未来团队在维护的时候产生较大的技术困难。还有一点也是今年 airbnb 等使用 RN 的代表公司放弃 RN 给我留下的心理阴影- -。

之所以选用 ionic 作为前端的组件库是因为我在做调研的时候被它的介绍所吸引了。跨平台、高性能保证、使用 web-component 作组件封装、对目前的前端三大框架都做了支持、简洁响应式并支持主题切换的 UI 设计、同样封装了大量原生方法并提供 api。官网的介绍确实是比较诱人了，另一方面，ionic 本身也是一个维护了很多年的项目，且 4.0+新版本的发布也才过去不久，github 上的更新频率也足够快，整体值得信赖。  
而我们项目本身又是一个 MVP 试错的新项目以及我作为程序员喜欢尝鲜的特点，我最终决定试一试。

# 使用体验

先说使用一个多月后的一个总体感觉。  
首先，坑确实不少。

1. 组件样式修改和自定义有难度。这一点有点成也 web-compnent，败也 web-component。ionic 使用 web-component 作组件封装，组件的 dom 结构和 css 都封装在 shadow dom 中，修改样式的方式就是使用 css 变量并向外暴露。这样的方式除了修改 css 变量本身稍显麻烦意外本来没有什么问题，但 ionic 给我的感觉是做的不够彻底。经常遇到需要修改的 css 样式没通过 css 变量做，而是需要直接写样式覆盖，或者写死于全局样式让人担心覆盖后产生的影响，或者写死于 shadow-dom 内无法修改的情况。一方面找这种 css 存在层级比较麻烦，另一方面也增加了开发者和 UI 的沟通成本。

2. 提供的组件库不是特别全。就组件库的完整度来说，ionic 还有一段路要走。在实际使用的时候，因为已经引入了 ionic，所以我们暂时没有考虑引入其它的组件库，那么就会遇到不少组件需要自己开发的情况，对于小项目组来说也是一项负担。项目做了一个月，自开发的比较耗时的公共组件数量就达到 4 个，未来肯定会更多。而且自开发的组件和 DOM 结构要接入 ionic 生态，比如支持 theme，使用 css 变量等，也算是负担。

3. documentation 的完整度不足且只有英文，虽然有文档也有 example，但 example 有些敷衍，文档整体结构和描述也不够清晰。且目前没有中文文档，对于团队成员的培养也是一个问题。

4. 对 react 支持不足，不少组件目前还没有 react 版本，或者有了 react 版本文档却没有更新，依然写着“not support react”。

优点当然也是存在的：

1. 主题切换确实比较方便，只要定义好 css 结构并且做好自定义组件和各种 html css 的接入(按照 ionic 的方式使用 root 和 host 下的 css 变量)。那么主题就真正可以做到一键切换。对于我们这种用户独立部署的产品来说非常实用。
2. 性能还不错。不同组件在 ios 和 android 都使用了原生来实现，且通过 mode 来进行样式的切换。不管从样式和手势体验还是性能上给到用户的使用感受确实很有原生 app 的感觉。
3. 因为使用了 web-component，所以 dom 结构非常清晰。对 css 调试和单元测试都提供了一些方便。

# 实践经验总结

todo
